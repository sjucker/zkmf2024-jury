<div>
  <app-header header="ZKMF2024 - Sekretariat"></app-header>
  <div class="loading-indicator">
    @if (showProgressBar()) {
      <mat-progress-bar mode="indeterminate" color="accent"></mat-progress-bar>
    }
  </div>

  <div class="max-width-container">
    <mat-card>
      <mat-card-content>
        <mat-form-field appearance="outline">
          <mat-label>Verein auswählen</mat-label>
          <mat-select [(ngModel)]="value" required>
            @for (option of options; track option) {
              <mat-option [value]="option">{{ option.startTime | date: 'dd.MM.yyyy, HH:mm' }} - {{ option.endTime | date:'HH:mm' }} {{ option.vereinsname }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
        @if (value) {
          <h3>{{ value.vereinsname }}</h3>
          <p><b>Vorgabe Dauer</b>:
            {{ formatDuration(value.minDurationInSeconds) }} - {{ formatDuration(value.maxDurationInSeconds) }}<br/>
            <b>Jury</b>: {{ value.jury }}
          </p>
          <p class="form-layout">
            <button color="primary" mat-flat-button [disabled]="value.started || saving()" (click)="started()">Vortrag gestartet</button>
            <button color="primary" mat-flat-button [disabled]="(!value.started || value.ended) || saving()" (click)="ended()">Vortrag beendet</button>
          </p>

          <h3>Zeitlimite</h3>
          <p>
            Gemessen wird die Zeit von Beginn bis Ende des Programmes, inkl. Zwischenapplaus (ohne Schlussapplaus). Die Zeitmessung obliegt dem Jurysekretariat.<br/>
            Bei Abweichungen von der Zeitlimite werden dem Verein pro angebrochene Minute von der Wertung 2 Punkte abgezogen.</p>
          <div>
            <mat-form-field appearance="outline">
              <mat-label>Angebrochene Minuten über oder unter der Zeitlimite</mat-label>
              <input type="number"
                     autocomplete="off"
                     matInput
                     min="0"
                     max="100"
                     step="1"
                     [(ngModel)]="value.minutesOverrun"/>
            </mat-form-field>
            <button color="primary" mat-flat-button [disabled]="((value.minutesOverrun ?? 0) < 1) || saving()" (click)="penalty()">Speichern</button>
            <div></div>
          </div>
        }
      </mat-card-content>
    </mat-card>
  </div>
</div>
